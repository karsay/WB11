テキスト情報

コンピュータセキュリティの分野におけるキャプチャー・ザ・フラッグ（CTF）は、コンピュータセキュリティ技術の競技である。CTFは通常、参加者に対しコンピュータを守る経験に加え、現実の世界で発見されたサイバー攻撃への対処を学ぶ教育手法として企画されている。「ハッカーコンテスト」[1]「ハッキング大会」[2]「ハッキング技術コンテスト」[3]「ハッカー大会」などとも訳される。

毎年ラスベガスで開催される世界最大規模のコンピュータセキュリティの会議DEF CON（英語版）において、当初余興としてCTFが始まった。現在では毎年恒例の人気コンテンツと化している。このDEFCONでのCTFでは、パケット分析、プロトコル解析、システム管理、プログラミング、暗号解読などの知識や技能が試される。CTFには、主に攻防戦形式とクイズ形式の2つの形式がある。現在ではハッカーコンテストとしてのCTFは世界各地で開催されている。日本では、2012年にホワイトハッカー育成を目的として、「CTFチャレンジジャパン 2012」が開催された[4]。なお、現時点では、DEFCONでのCTF決勝戦が世界最高峰の戦いであるとされており、世界中で行われるほとんどのCTFもそれに模した構成となっている。毎年若干の内容変更が進められているが、以下に典型的なDEFCONでのCTFを述べる。

・リバースエンジニアリング
Binaryとも呼ばれる。基本的にはシリアルキーのクラッキングなどと同じ技術を用いてフラッグ（旗に相当するファイルの内容）を奪取することで得点となる。
・Forensics
HDDやUSBメモリや物理メモリのイメージファイルを解析し、その中からフラッグを奪取することで得点となる。
・Pwnable
プログラムの脆弱性を突き、不正侵入・不正昇格をすることで得点となる。
基本的な部分はBinaryと同じ（攻撃対象の解析）だが、脆弱性の発見及び脆弱性を攻略するExploitコードを記述する技術が必要である。
サーバ内のフラッグを奪取することで得点となる。
・Web
ウェブアプリケーションの脆弱性を突いて（XSS・SQLインジェクション・OSコマンドインジェクションなど）サーバ内に侵入し、フラッグを奪取することで得点となる。
・Network
ネットワークのパケットを解析し、その中からフラッグを奪取することで得点となる。
ネットワークの基礎的な知識と、それぞれのプロトコルに関する深い知識が要求される。
・Miscellaneous
上記ジャンルに分類できない、またはセキュリティ関係の雑学やパズルなどの問題が出題される。

・攻防戦形式
攻防戦形式（英語:attack/defense style）では、各チームに守るべきコンピュータ（または小規模なネットワーク）が割り当てられ、自チームのコンピュータに対する相手からの攻撃の防御成功、及び相手のコンピュータに対する攻撃の成功に対し得点が与えられる。個々のCTFのルールによって、相手のコンピュータに侵入して情報を奪う（相手の旗を奪う）又は情報を書き込む（自分の旗を立てる）ことを企図する。著名な攻防戦形式のCTFのひとつは、毎年開催されるDEF CONで行われているものである。

多数のチームが参加するCTFにおいては、防御側コンピュータを主催者が用意し、参加者は攻撃側として、主催者が隠した複数の課題や脆弱性を突き、いくつ情報を奪うか（または情報を書き込むか）で競う場合もある。

・クイズ形式
クイズ形式（アメリカの長寿クイズ番組Jeopardy!に因み、英語ではjeopardy styleと呼ばれる）においては、各チームは、通常異なる配点の、複数の分野にわたる問題を解答する。また、クイズ形式では防御を行わないため、参加者は攻撃に集中できるが、他チームから受けた攻撃コードを流用した攻撃ができないという一面もある。 また、クイズ形式のCTFは常時開催型の物も存在する。[5]

Network
→ネットワークに関する問題。Wiresharkを使ったパケット解析など。

・暗号化が施されていない通信プロトコルからフラッグを見つける初歩的な問題を解いていくのが王道。


Cryptography( Crypto )
→暗号に関する問題。簡単なものでシーザー暗号、難しいものでは数学の深い知識が要求されるものもある。

・各種暗号はネット上に解いてくれるWebサイト・ツールが転がっているので、素直に使った方が楽。でもコード書いても勉強になる。

(ちなみに先日、RSA暗号関連のCrypto問題が全く分からず、CTF強い勢の方に相談したら、「積攻撃」なるものを使うとおっしゃっていました。ﾅﾆｿﾚ(´；ω；`) )

Binary ( Bin )
→バイナリファイルを解析する問題。後述するReversingと似ているため、両者を区別しないことも。(個人的にはReversingの方がメジャー？)

・StringsコマンドでFLAGが手に入るもの簡単なものから、かなり経験を積んだ人しか解けないようなものもある。個人的に苦手。

Reversing ( Rev )
→リバースエンジニアリングに関する問題。

・難しい。解けなくても落ち込む必要はありません(´・ω・`)

・C言語やアセンブリ言語の知識が前提。加えて、メモリやレジスタの知識も要求される。

・個人的に、かなり経験を積まないと解けないと思っている。(´；ω；`)

・以下のスライドが参考になるかもしれません

 

Pwn
→プログラムの脆弱性を突く分野(エクスプロイトする、とも言う)。

・世間一般の人々が想像するハッカーがやってることに最も近いイメージで、かつ難易度がとても高い(； ･`ω･´)

・Reversingなどの他分野の知識がかなり要求されるので、初心者がpwnから入るのはおすすめしない。

( というか私は自力で解けたpwnがまだありません。笑 )

Forensic
→フォレンジック。データから情報を抜き出しFLAGを探します。

 

・fileコマンドでファイルの種類を調べたり、時には画像ファイルをバイナリエディタにぶち込んだりしてFLAGが紛れてないか調べます。

・あれこれ思案しながら解けるので、個人的に一番好きな分野( ･`ω･´)

・このQiitaの記事に載っている知識で結構解けます

Steganography ( Stego )
→ステガノグラフィ。音声や画像データに隠されたFLAGを見つけたりする。

・分野的にはForensicと似てるかもしれない(区別しないサイトもある)

・stegosolveやzstegなどツールを使うこと前提。


Web
Webアプリケーション䛾脆弱性を探しだして
攻撃する
例え䜀Webエンジニア
Webアプリケーションを作成する人がセキュリティ
を知らないと大変なことに・・・
攻撃方法を知ることで安全なアプリケーション
を作れる！

Pwnable
OSやプログラム䛾脆弱性(セキュリティ上䛾弱点)
を見つけて攻撃を行う
例え䜀サーバ管理
インターネットに公開しているサーバ䛿安全?
依頼されたシステムがセキュアかどうかを
診断する仕事もある

HDDやUSBメモリ，物理メモリ䛾イメージファイル
を解析し，必要な情報を得る
例え䜀犯罪捜査
不正アクセスや機密情報漏洩が起こったとき
● 消えたファイルを特定
● 一部が壊れたデータ䛾復元
● ファイル䛾タイムスタンプ䛾調査

ネットワーク
ネットワークを流れるトラフィックを
キャプチャして、それを分析・解析する
例え䜀ネットワーク管理
ネットワーク機器䛾設定に必要な知識
ネットワークを理解することで
トラブル発生時に、原因調査ができる！

リバースエンジニアリング
ソースコード䛾ないプログラムを解析する
デバッガによる実行
機械語からアセンブリ言語へ変換
例え䜀マルウェア解析
悪意䛾あるプログラム䛾動作を特定する

主な出題分野
● リバースエンジニアリング
● ネットワーク
● フォレンジクス
● Pwnable(脆弱性調査)
● Web
● そ䛾他
○ 暗号
○ プログラミング

CTFと䛿？
Capture The Flag（旗取りゲーム）䛾略
情報セキュリティ䛾技術を競う競技・ゲーム
隠された答え（Flag）をセキュリティ䛾スキルを用いて
探し、答えをサーバへ送信するクイズ形式が多い
